Email
=====

**Mastodon** uses email to get in touch with an account holder for different purposes.
Mastodon uses outbound email only and do not process any inbound email.
Instance administrator can also avoid using email altogether by confirming users themselves.
This document highlight what emails are used for and where to change email configuration.  
To go further,this document describe the default component involved from mastodon, rails and the OS and how they interact together.
 
### What is email used for in Mastodon?
In the default case, email will be first sent to confirm your user.
Users can also choose to receive notification for various types of activity.
Finally password reset and password reset confirmation is done via email.
Instance admin can avoid using emails altogether too.
- [Emails in the signup process](diagrams/README.md#sign-up-process)
- [Emails and notification](diagrams/README.md#notification-process)
- [Emails during password reset](diagrams/README.md#password-reset-process)

### How to configure email in Mastodon ?
By default, mastodon use the SMTP protocol to send emails.
In most cases, you will configure an SMTP endpoint that will receive emails from mastodon and deliver them to user's email provider on your behalf.
Instance admin can avoid using emails altogether too.
- [Using Mastodon without email](configuration/README.md#without_emails)
- [Understanding SMTP parameters:](configuration/README.md#smtp_parameters)
- [Configure an SMTP provider: mailgun example](configuration/README.md#mailgun_example)
- [SMTP best practice](configuration/README.md#smtp_best_practice)
- [Configure a sendmail compatible relay](configuration/README.md#sendmail_example)
- [Best practice for email](configuration/README.md#email_best_practice)

### Troubleshooting emails
Toubleshooting why users don't receive emails requires to follow emails at many layers. Emails are generated by the rails app, stored in redis and sent actioned a sidekiq worker. Actionmailer is used to send the email and openssl is used if TLS is enabled to communicate with your SMTP provider. 
The provider reveiving mastodon emails will likely do checks to understand if your emails are legitimate or not.
- [Understanding the components involved in Mastodon](troubleshooting/README.md#email_workflow)
- [Troubleshooting emails in mastodon](troubleshooting/README.md#emails_inside_mastodon)
- [Troubleshooting emails outside of mastodon](troubleshooting/README.md#emails_outside_mastodon)
